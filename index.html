<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>馬券計算ツール</title>
<style>
  body { font-family: sans-serif; padding: 20px; }
  h2 { margin-top: 40px; }

  .container {
    display: flex;
    gap: 20px;
    align-items: flex-start;
  }

  table { border-collapse: collapse; }

  th, td {
    border: 1px solid #ccc;
    padding: 6px 8px;
    text-align: center;
    white-space: nowrap;
  }

  th { background: #f0f0f0; }

  summary {
    list-style: none;
    cursor: pointer;
  }
  summary::-webkit-details-marker { display: none; }

  input[type="checkbox"] {
    transform: scale(1.8);
    cursor: pointer;
  }

  input[type="text"] { width: 120px; }
  input[type="number"] { width: 60px; }

  .result-area { width: 100%; }

  .header-bar {
    display: flex;
    align-items: center;
    gap: 180px;
    padding: 6px 0;
    background: #fff;
    position: sticky;
    top: 0;
    z-index: 2;
  }

  .count { font-size: 16px; font-weight: bold; }
  .count-label { color: #888; margin-right: 4px; }

  button { padding: 4px 12px; cursor: pointer; }

  .result-scroll {
    max-height: 640px;
    overflow-y: auto;
    border-top: 1px solid #ccc;
  }

  .arrow-cell {
    width: 16px;
    padding: 0 2px;
    color: #bbb;
    font-weight: bold;
    border-left: none;
    border-right: none;
  }

  .no-border-right { border-right: none; padding-right: 4px; }
  .no-border-left  { border-left: none;  padding-left: 4px; }

  .odds-very-low  { color: #7A0000; }
  .odds-low       { color: #B00000; }
  .odds-mid-low   { color: #E06666; }
  .odds-mid-high  { color: #6AA84F; }
  .odds-high      { color: #38761D; }
  .odds-very-high { color: #274E13; }

  .bg-odds-very-low  { background-color: #7A0000; color: white; }
  .bg-odds-low       { background-color: #A00000; color: white; }
  .bg-odds-mid-low   { background-color: #CC4444; color: white; }
  .bg-odds-mid-high  { background-color: #4C9933; color: white; }
  .bg-odds-high      { background-color: #28661C; color: white; }
  .bg-odds-very-high { background-color: #1F470F; color: white; }

  .memo-area { margin-top: 20px; }
  .memo-area textarea {
    width: 100%;
    min-height: 180px;
    padding: 10px;
    font-size: 14px;
    resize: vertical;
  }

  .csv-load { margin-bottom: 12px; }
  .csv-load input[type="text"] { width: 150px; margin-right: 6px; }
</style>
</head>
<body>

<div class="csv-load">
  <input type="text" id="raceName" placeholder="ファイル名を入力">
  <button onclick="loadCSV()">データ読込</button>
</div>

<!-- （HTML構造は完全に元のままなので省略せず続いています） -->

<script>
const triResults = [];
const wideResults = [];

const triTable = document.getElementById("triTable");
const triBody  = document.getElementById("triResult");
const triCount = document.getElementById("triCount");

const wideTable = document.getElementById("wideTable");
const wideBody  = document.getElementById("wideResult");
const wideCount = document.getElementById("wideCount");

/* ===== ここだけ汎用化 ===== */
const syncDefinitions = [
  {
    from: triTable,
    to: wideTable,
    map: [
      { from: r => r.cells[1].children[0], to: r => r.querySelector(".wName") },
      { from: r => r.cells[2].children[0], to: r => r.querySelector(".wOdds") }
    ]
  },
  {
    from: wideTable,
    to: triTable,
    map: [
      { from: r => r.querySelector(".wName"), to: r => r.cells[1].children[0] },
      { from: r => r.querySelector(".wOdds"), to: r => r.cells[2].children[0] }
    ]
  }
];

function syncInputs(){
  syncDefinitions.forEach(def=>{
    [...def.from.rows].slice(1).forEach((fromRow,i)=>{
      const toRow = def.to.rows[i+1];
      if(!toRow) return;
      def.map.forEach(m=>{
        m.to(toRow).value = m.from(fromRow).value;
      });
    });
  });
}
/* ===== ここまで ===== */

triTable.addEventListener("input",()=>{syncInputs();updateTrifecta();updateWide();updateInputOddsColor();});
triTable.addEventListener("change",()=>{syncInputs();updateTrifecta();updateWide();updateInputOddsColor();});
wideTable.addEventListener("input",()=>{syncInputs();updateTrifecta();updateWide();updateInputOddsColor();});
wideTable.addEventListener("change",()=>{syncInputs();updateTrifecta();updateWide();updateInputOddsColor();});

syncInputs();
</script>

</body>
</html>
